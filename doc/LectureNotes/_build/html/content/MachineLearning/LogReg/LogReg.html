
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>31. Logistic Regression &#8212; Learning from data</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="32. Neural networks" href="../NeuralNet/NeuralNet.html" />
    <link rel="prev" title="30. Exercise: Gaussian processes" href="../GP/exercise_GP.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learning from data</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/welcome.html">
   Course aim
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/Intro.html">
   1. Learning from data: Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/demo-Intro.html">
   2. Reading Data and fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/exercise_Jupyter_Python_intro_01.html">
   4. Python and Jupyter notebooks: part 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/exercise_Jupyter_Python_intro_02.html">
   5. Python and Jupyter notebooks: part 02
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Linear regression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/LinearRegression.html">
   6. Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/ModelValidation.html">
   7. Model validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/demo-ModelValidation.html">
   9. Linear Regression and Model Validation demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/exercise_LinearRegression.html">
   10. Linear Regression exercise
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Bayesian statistics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianBasics/BayesianBasics.html">
   11. Statistical inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianBasics/BayesianRecipe.html">
   12. The Bayesian recipe
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianBasics/demo-BayesianBasics.html">
   13. Interactive Bayesian Coin Tossing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianBasics/exercise_sum_product_rule.html">
   14. Checking the sum and product rules, and their consequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianParameterEstimation/BayesianParameterEstimation.html">
   15. Inference With Parametric Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianParameterEstimation/demo-BayesianParameterEstimation.html">
   16. Bayesian parameter estimation demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/BayesianParameterEstimation/exercise_BayesianParameterEstimation.html">
   17. Exercise: Bayesian parameter estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/MCMC/MCMC.html">
   18. Why MCMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/MCMC/demo-MCMC.html">
   19. Metropolis-Hasting MCMC sampling of a Poisson distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/ErrorPropagation/ErrorPropagation.html">
   20. Why Bayes is Better
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/ErrorPropagation/demo-ErrorPropagation.html">
   21. Learning from Data: Error propagation and nuisance parameters (demonstration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/MaxEnt/IgnorancePDF.html">
   24. Ignorance pdfs: Indifference and translation groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/MaxEnt/MaxEnt.html">
   25. The principle of maximum entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/MaxEnt/demo-MaxEnt.html">
   26. Assigning probabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../BayesianStatistics/ModelSelection/ModelSelection.html">
   27. Model Selection
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine learning-A Bayesian perspective
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../GP/GaussianProcesses.html">
   28. Gaussian processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../GP/demo-GaussianProcesses.html">
   29. Gaussian processes demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../GP/exercise_GP.html">
   30. Exercise: Gaussian processes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   31. Logistic Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NeuralNet/NeuralNet.html">
   32. Neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NeuralNet/demo-NeuralNet.html">
   33. Neural network classifier demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NeuralNet/exercises_LogReg_NeuralNet.html">
   34. Exercise: Logistic Regression and neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CNN/cnn.html">
   35. Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CNN/demo-cnn.html">
   36. Image recognition demonstration with Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BNN/bnn.html">
   37. Bayesian neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BNN/demo-bnn.html">
   38. Variational Inference: Bayesian Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BNN/exercises_BNN.html">
   39. Exercise: Bayesian neural networks
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/MachineLearning/LogReg/LogReg.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/physics-chalmers/tif285"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/physics-chalmers/tif285/issues/new?title=Issue%20on%20page%20%2Fcontent/MachineLearning/LogReg/LogReg.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-and-deep-learning">
   31.1. Optimization and Deep learning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basics-and-notation">
   31.2. Basics and notation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#binary-classification">
   31.3. Binary classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-classifier">
     Linear classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#some-selected-properties">
     Some selected properties
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-logistic-function">
     The logistic function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-activation-functions">
     Standard activation functions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-binary-classifier-with-two-parameters">
     A binary classifier with two parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determination-of-weights">
     Determination of weights
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-likelihood">
       Maximum likelihood
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-cost-function-rewritten-as-cross-entropy">
       The cost function rewritten as cross entropy
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#regularization">
       Regularization
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimizing-the-cross-entropy">
       Minimizing the cross entropy
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-more-compact-expression">
       A more compact expression
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-learning-algorithm">
     A learning algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extending-to-more-predictors">
       Extending to more predictors
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#including-more-classes">
   31.4. Including more classes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#class-probabilities-the-softmax-function">
     Class probabilities: The Softmax function
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- !split  -->
<div class="section" id="logistic-regression">
<h1><span class="section-number">31. </span>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this headline">¶</a></h1>
<p>In linear regression our main interest was centered on learning the
coefficients of a functional fit (say a polynomial) in order to be
able to predict the response of a continuous variable on some unseen
data. The fit to the continuous variable <span class="math notranslate nohighlight">\(y^{(i)}\)</span> is based on some
independent variables <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)}\)</span>. Linear regression resulted in
analytical expressions for standard ordinary Least Squares or Ridge
regression (in terms of matrices to invert) for several quantities,
ranging from the variance and thereby the confidence intervals of the
parameters <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span> to the mean squared error. If we can invert
the product of the design matrices, linear regression gives then a
simple recipe for fitting our data.</p>
<p>Classification problems, however, are concerned with outcomes taking
the form of discrete variables (i.e. categories). We may for example,
on the basis of DNA sequencing for a number of patients, like to find
out which mutations are important for a certain disease; or based on
scans of various patients’ brains, figure out if there is a tumor or
not; or given a specific physical system, we’d like to identify its
state, say whether it is an ordered or disordered system (typical
situation in solid state physics); or classify the status of a
patient, whether she/he has a stroke or not and many other similar
situations.</p>
<p>The most common situation we encounter when we apply logistic
regression is that of two possible outcomes, normally denoted as a
binary outcome, true or false, positive or negative, success or
failure etc.</p>
<!-- !split -->
<div class="section" id="optimization-and-deep-learning">
<h2><span class="section-number">31.1. </span>Optimization and Deep learning<a class="headerlink" href="#optimization-and-deep-learning" title="Permalink to this headline">¶</a></h2>
<p>Logistic regression will also serve as our stepping stone towards
neural network algorithms and supervised deep learning. For logistic
learning, the minimization of the cost function leads to a non-linear
equation in the parameters <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span>. The optimization of the
problem calls therefore for minimization algorithms. This forms the
bottle neck of all machine learning algorithms, namely how to find
reliable minima of a multi-variable function. This leads us to the
family of gradient descent methods. The latter are the working horses
of basically all modern machine learning algorithms.</p>
<p>We note also that many of the topics discussed here on logistic
regression are also commonly used in modern supervised Deep Learning
models, as we will see later.</p>
<!-- !split  -->
</div>
<div class="section" id="basics-and-notation">
<h2><span class="section-number">31.2. </span>Basics and notation<a class="headerlink" href="#basics-and-notation" title="Permalink to this headline">¶</a></h2>
<p>We consider the case where the dependent variables (also called the
responses, targets, or outcomes) are discrete and only take values
from <span class="math notranslate nohighlight">\(k=0,\dots,K-1\)</span> (i.e. <span class="math notranslate nohighlight">\(K\)</span> classes).</p>
<p>The goal is to predict the
output classes from the design matrix <span class="math notranslate nohighlight">\(\boldsymbol{X}\in\mathbb{R}^{n\times p}\)</span>
made of <span class="math notranslate nohighlight">\(n\)</span> samples, each of which carries <span class="math notranslate nohighlight">\(p\)</span> features or predictors. The
primary goal is to identify the classes to which new unseen samples
belong.</p>
<p><em>Notice.</em>
We will use the following notation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span>: independent (input) variables, typically a vector of length <span class="math notranslate nohighlight">\(p\)</span>. A matrix of <span class="math notranslate nohighlight">\(n\)</span> instances of input vectors is denoted <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span>, and is also known as the <em>design matrix</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span>: dependent, response variable, also known as the target. For binary classification the target <span class="math notranslate nohighlight">\(t^{(i)} \in \{0,1\}\)</span>. For <span class="math notranslate nohighlight">\(K\)</span> different classes we would have <span class="math notranslate nohighlight">\(t^{(i)} \in \{1, 2, \ldots, K\}\)</span>. A vector of <span class="math notranslate nohighlight">\(n\)</span> targets from <span class="math notranslate nohighlight">\(n\)</span> instances of data is denoted <span class="math notranslate nohighlight">\(\boldsymbol{t}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{D}\)</span>: is the data, where <span class="math notranslate nohighlight">\(\mathcal{D}^{(i)} = \{ (\boldsymbol{x}^{(i)}, t^{(i)} ) \}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span>: is the output of our classifier that will be used to quantify probabilities <span class="math notranslate nohighlight">\(p_{t=C}\)</span> that the target belongs to class <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span>: will be the parameters (weights) of our classification model.</p></li>
</ul>
<!-- !split  -->
</div>
<div class="section" id="binary-classification">
<h2><span class="section-number">31.3. </span>Binary classification<a class="headerlink" href="#binary-classification" title="Permalink to this headline">¶</a></h2>
<p>Let us specialize to the case of two classes only, with outputs
<span class="math notranslate nohighlight">\(t^{(i)} \in \{0,1\}\)</span>. That is</p>
<div class="math notranslate nohighlight">
\[\begin{split}t^{(i)} = \begin{bmatrix} 0 \\  1 \end{bmatrix}
= \begin{bmatrix} \mathrm{no}\\  \mathrm{yes} \end{bmatrix}.\end{split}\]</div>
<!-- !split -->
<div class="section" id="linear-classifier">
<h3>Linear classifier<a class="headerlink" href="#linear-classifier" title="Permalink to this headline">¶</a></h3>
<p>Before moving to the logistic model, let us try to use our linear
regression model to classify these two outcomes. We could for example
fit a linear model to the default case if <span class="math notranslate nohighlight">\(y^{(i)} &gt; 0.5\)</span> and the no
default case <span class="math notranslate nohighlight">\(y^{(i)} \leq 0.5\)</span>.</p>
<p>We would then have our
weighted linear combination, namely</p>
<div class="amsmath math notranslate nohighlight" id="equation-8e3ed720-9c9b-49f1-9051-ad70f263f58e">
<span class="eqno">(31.1)<a class="headerlink" href="#equation-8e3ed720-9c9b-49f1-9051-ad70f263f58e" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\boldsymbol{\tilde{y}} = \boldsymbol{X}^T\boldsymbol{w} +  \boldsymbol{\epsilon},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> is a vector representing the possible outcomes, <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> is our
<span class="math notranslate nohighlight">\(n\times p\)</span> design matrix and <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span> represents our estimators/predictors.</p>
<!-- !split -->
</div>
<div class="section" id="some-selected-properties">
<h3>Some selected properties<a class="headerlink" href="#some-selected-properties" title="Permalink to this headline">¶</a></h3>
<p>The main problem with our function is that it takes values on the
entire real axis. In the case of logistic regression, however, the
labels <span class="math notranslate nohighlight">\(t^{(i)}\)</span> are discrete variables.</p>
<p>One simple way to get a discrete output is to have sign
functions that map the output of a linear regressor to values <span class="math notranslate nohighlight">\(y^{(i)} \in \{ 0, 1 \}\)</span>,
<span class="math notranslate nohighlight">\(y^{(i)} = f(\tilde{y}^{(i)})=\frac{\mathrm{sign}(\tilde{y}^{(i)})+1}{2}\)</span>, which will map to one if <span class="math notranslate nohighlight">\(\tilde{y}^{(i)}\ge 0\)</span> and zero otherwise.
We will encounter this model in our first demonstration of neural networks. Historically it is called the <em>perceptron</em> model in the machine learning
literature. This model is extremely simple. However, in many cases it is more
favorable to use a <em>soft</em> classifier that outputs
the probability of a given category. This leads us to the logistic function.</p>
<!-- !split -->
</div>
<div class="section" id="the-logistic-function">
<h3>The logistic function<a class="headerlink" href="#the-logistic-function" title="Permalink to this headline">¶</a></h3>
<p>The perceptron is an example of a “hard classification” model. We
will encounter this model when we discuss neural networks as
well. Each datapoint is deterministically assigned to a category (i.e
<span class="math notranslate nohighlight">\(y^{(i)}=0\)</span> or <span class="math notranslate nohighlight">\(y^{(i)}=1\)</span>). In many cases, it is favorable to have a “soft”
classifier that outputs the probability of a given category rather
than a single value. For example, given <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)}\)</span>, the classifier
outputs the probability of being in a category <span class="math notranslate nohighlight">\(k\)</span>.  Logistic regression
is the most common example of such a soft classifier. In logistic
regression, the probability that a data point <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)}\)</span>
belongs to a category <span class="math notranslate nohighlight">\(t^{(i)} \in \{0,1\}\)</span> is given by the so-called <em>logit</em> function (an example of a S-shape or <em>Sigmoid</em> function) which is meant to represent the likelihood for a given event,</p>
<div class="math notranslate nohighlight">
\[y(\boldsymbol{x}; \boldsymbol{w}) = y(a) = \frac{1}{1+e^{-a}} = \frac{e^a}{1+e^a},\]</div>
<p>where the so called <em>activation</em> <span class="math notranslate nohighlight">\(a = a(\boldsymbol{x}; \boldsymbol{w})\)</span>.</p>
<ul class="simple">
<li><p>Most frequently one uses <span class="math notranslate nohighlight">\(a = a(\boldsymbol{x}, \boldsymbol{w}) \equiv \boldsymbol{x} \cdot \boldsymbol{w}\)</span>.</p></li>
<li><p>Note that <span class="math notranslate nohighlight">\(1-y(a)= y(-a)\)</span>.</p></li>
<li><p>The sigmoid function can be motivated in several different ways. E.g. in information theory this function represents the probability of a signal <span class="math notranslate nohighlight">\(s=1\)</span> rather than <span class="math notranslate nohighlight">\(s=0\)</span> when transmission occurs over a noisy channel.</p></li>
</ul>
<!-- !split -->
</div>
<div class="section" id="standard-activation-functions">
<h3>Standard activation functions<a class="headerlink" href="#standard-activation-functions" title="Permalink to this headline">¶</a></h3>
<!-- <img src="fig/LogReg/logistic_functions.png" width=600><p><em>The sigmoid, step,and (normalized) tanh functions; three common classifier functions used in classification and neural networks. <div id="fig:logistic"></div></em></p> -->
<p><img alt="The sigmoid, step,and (normalized) tanh functions; three common classifier functions used in classification and neural networks. " src="content/MachineLearning/LogReg/fig/LogReg/logistic_functions.png" /></p>
<!-- !split -->
</div>
<div class="section" id="a-binary-classifier-with-two-parameters">
<h3>A binary classifier with two parameters<a class="headerlink" href="#a-binary-classifier-with-two-parameters" title="Permalink to this headline">¶</a></h3>
<p>We assume now that we have two classes with <span class="math notranslate nohighlight">\(t^{(i)}\)</span> being either <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>. Furthermore we assume also that we have only two parameters <span class="math notranslate nohighlight">\(w_0, w_1\)</span> and the predictors <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)} = \{ 1, x^{(i)} \}\)</span> defining the Sigmoid function. I.e., there is a single independent (input) variable <span class="math notranslate nohighlight">\(x\)</span>. We can produce probabilities from the classifier output <span class="math notranslate nohighlight">\(y^{(i)}\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
p(t^{(i)}=1|x^{(i)},\boldsymbol{w}) &amp;= y(a^{(i)})= \frac{\exp{(w_0+w_1x^{(i)})}}{1+\exp{(w_0+w_1x^{(i)})}},\\
p(t^{(i)}=0|x^{(i)},\boldsymbol{w}) &amp;= 1 - p(t^{(i)}=1|x^{(i)},\boldsymbol{w}) = \frac{1}{1+\exp{(w_0+w_1x^{(i)})}},
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{w} = ( w_0, w_1)\)</span> are the weights we wish to extract from training data.</p>
<p>Note that <span class="math notranslate nohighlight">\([p(t^{(i)}=0), p(t^{(i)}=1)]\)</span> is a discrete set of probabilities that we will still refer to as a probability distribution.</p>
<!-- !split -->
</div>
<div class="section" id="determination-of-weights">
<h3>Determination of weights<a class="headerlink" href="#determination-of-weights" title="Permalink to this headline">¶</a></h3>
<p>Among ML practitioners, the prevalent approach to determine the weights in the activation function(s) is by minimizing some kind of cost function using some version of gradient descent. As we will see this usually corresponds to maximizing a likelihood function with or without a regularizer.</p>
<p>In this course we will obviously also advocate (or at least make aware of) the more probabilistic approach to learning about these parameters.</p>
<!-- !split  -->
<div class="section" id="maximum-likelihood">
<h4>Maximum likelihood<a class="headerlink" href="#maximum-likelihood" title="Permalink to this headline">¶</a></h4>
<p>In order to define the total likelihood for all possible outcomes from a<br />
dataset <span class="math notranslate nohighlight">\(\mathcal{D}=\{(x^{(i)}, t^{(i)},)\}\)</span>, with the binary labels
<span class="math notranslate nohighlight">\(t^{(i)}\in\{0,1\}\)</span> and where the data points are drawn independently, we use the binary version of the <a class="reference external" href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation">Maximum Likelihood Estimation</a> (MLE) principle.
We express the
likelihood in terms of the product of the individual probabilities of a specific outcome <span class="math notranslate nohighlight">\(t^{(i)}\)</span>, that is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\mathcal{L} = P(\mathcal{D}|\boldsymbol{w})&amp; = \prod_{i=1}^n \left[p(t^{(i)}=1|x^{(i)},\boldsymbol{w})\right]^{t^{(i)}}\left[1-p(t^{(i)}=1|x^{(i)},\boldsymbol{w}))\right]^{1-t^{(i)}}\nonumber \\
\end{align*}\]</div>
<p>from which we obtain the log-likelihood</p>
<div class="math notranslate nohighlight">
\[L \equiv \log(\mathcal{L}) = \sum_{i=1}^n \left( t^{(i)}\log{p(t^{(i)}=1|x^{(i)},\boldsymbol{w})} + (1-t^{(i)})\log\left[1-p(t^{(i)}=1|x^{(i)},\boldsymbol{w}))\right]\right).\]</div>
<p>The <strong>cost/loss</strong> function is then defined as the negative log-likelihood</p>
<div class="math notranslate nohighlight">
\[\mathcal{C}(\boldsymbol{w}) \equiv -L = -\sum_{i=1}^n \left( t^{(i)}\log{p(t^{(i)}=1|x^{(i)},\boldsymbol{w})} + (1-t^{(i)})\log\left[1-p(t^{(i)}=1|x^{(i)},\boldsymbol{w}))\right]\right).\]</div>
<!-- !split -->
</div>
<div class="section" id="the-cost-function-rewritten-as-cross-entropy">
<h4>The cost function rewritten as cross entropy<a class="headerlink" href="#the-cost-function-rewritten-as-cross-entropy" title="Permalink to this headline">¶</a></h4>
<p>Using the definitions of the probabilities we can rewrite the <strong>cost/loss</strong> function as</p>
<div class="math notranslate nohighlight">
\[\mathcal{C}(\boldsymbol{w}) = -\sum_{i=1}^n \left( t^{(i)}\log{ y(x^{(i)},\boldsymbol{w})} + (1-t^{(i)})\log\left[ 1-y( x^{(i)},\boldsymbol{w}) \right] \right),\]</div>
<p>which can be recognised as the relative entropy between the empirical probability distribution <span class="math notranslate nohighlight">\((t^{(i)}, 1-t^{(i)})\)</span> and the probability distribution predicted by the classifier <span class="math notranslate nohighlight">\((y^{(i)}, 1-y^{(i)})\)</span>.
Therefore, this cost function is known in statistics as the <strong>cross entropy</strong>.</p>
<p>Using specifically the logistic sigmoid activation function with two weights, and reordering the logarithms, we can rewrite the log-likelihood as</p>
<div class="math notranslate nohighlight">
\[L(\boldsymbol{w}) = \sum_{i=1}^n  \left[ t^{(i)}(w_0+w_1 x^{(i)}) -\log{(1+\exp{(w_0+w_1x^{(i)})})} \right].\]</div>
<p>The maximum likelihood estimator is defined as the set of parameters (weights) that maximizes the log-likelihood (where we maximize with respect to <span class="math notranslate nohighlight">\(w\)</span>).</p>
<p>Since the cost (error) function is here defined as the negative log-likelihood, for logistic regression, we have that</p>
<div class="math notranslate nohighlight">
\[\mathcal{C}(\boldsymbol{w})=-\sum_{i=1}^n  \left[ t^{(i)} (w_0+w_1x^{(i)}) -\log{ \left( 1+\exp{(w_0+w_1x^{(i)})} \right) } \right].\]</div>
<!-- !split -->
</div>
<div class="section" id="regularization">
<h4>Regularization<a class="headerlink" href="#regularization" title="Permalink to this headline">¶</a></h4>
<p>In practice, just as for linear regression, one often supplements the cross-entropy cost function with additional regularization terms, usually <span class="math notranslate nohighlight">\(L_1\)</span> and <span class="math notranslate nohighlight">\(L_2\)</span> regularization. This introduces hyperparameters into the classifier.</p>
<p>In particular, Lasso regularization is obtained by defining another cost function</p>
<div class="math notranslate nohighlight">
\[\mathcal{C}_W (\boldsymbol{w}) \equiv \mathcal{C} (\boldsymbol{w}) + \alpha E_W (\boldsymbol{w})\]</div>
<p>where <span class="math notranslate nohighlight">\(E_W (\boldsymbol{w}) = \frac{1}{2} \sum_j w_j^2\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> is known as the <em>weight decay</em>.</p>
<p><em>Question.</em>
Can you motivate why <span class="math notranslate nohighlight">\(\alpha\)</span> is known as the weight decay? <em>Hint</em>: Recall the origin of this regularizer from a Bayesian perspective.</p>
<!-- !split -->
</div>
<div class="section" id="minimizing-the-cross-entropy">
<h4>Minimizing the cross entropy<a class="headerlink" href="#minimizing-the-cross-entropy" title="Permalink to this headline">¶</a></h4>
<p>The cross entropy is a convex function of the weights <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span> and,
therefore, any local minimizer is a global minimizer.</p>
<p>Minimizing this cost function (here without regularization term) with respect to the two parameters <span class="math notranslate nohighlight">\(w_0\)</span> and <span class="math notranslate nohighlight">\(w_1\)</span> we obtain</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial \mathcal{C}(\boldsymbol{w})}{\partial w_0} 
&amp;= -\sum_{i=1}^n  \left(t^{(i)} -\frac{\exp{(w_0+w_1x^{(i)})}}{1+\exp{(w_0+w_1x^{(i)})}}\right)
&amp;= -\sum_{i=1}^n  \left(t^{(i)} - y^{(i)} \right), \\
\frac{\partial \mathcal{C}(\boldsymbol{w})}{\partial w_1} 
&amp;= -\sum_{i=1}^n  \left(t^{(i)} x^{(i)} -x^{(i)}\frac{\exp{(w_0+w_1x^{(i)})}}{1+\exp{(w_0+w_1x^{(i)})}}\right)
&amp;= -\sum_{i=1}^n  x^{(i)} \left(t^{(i)} - y^{(i)} \right).
\end{align*}\]</div>
<!-- !split -->
</div>
<div class="section" id="a-more-compact-expression">
<h4>A more compact expression<a class="headerlink" href="#a-more-compact-expression" title="Permalink to this headline">¶</a></h4>
<p>Let us now define a vector <span class="math notranslate nohighlight">\(\boldsymbol{t}\)</span> with <span class="math notranslate nohighlight">\(n\)</span> elements <span class="math notranslate nohighlight">\(t^{(i)}\)</span>, an
<span class="math notranslate nohighlight">\(n\times 2\)</span> matrix <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> which contains the <span class="math notranslate nohighlight">\((1, x^{(i)})\)</span> predictor variables, and a
vector <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> of the outputs <span class="math notranslate nohighlight">\(y^{(i)} = y(x^{(i)},\boldsymbol{w})\)</span>. We can then express the first
derivative of the cost function in matrix form</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathcal{C}(\boldsymbol{w})}{\partial \boldsymbol{w}} = -\boldsymbol{X}^T\left( \boldsymbol{t}-\boldsymbol{y} \right). \]</div>
<!-- !split -->
</div>
</div>
<div class="section" id="a-learning-algorithm">
<h3>A learning algorithm<a class="headerlink" href="#a-learning-algorithm" title="Permalink to this headline">¶</a></h3>
<p><em>Notice.</em>
Having access to the first derivative we can define an <em>on-line learning rule</em> as follows:</p>
<ul class="simple">
<li><p>For each input <span class="math notranslate nohighlight">\(i\)</span>, compute the error <span class="math notranslate nohighlight">\(e^{(i)} = t^{(i)} - y^{(i)}\)</span>.</p></li>
<li><p>Adjust the weights in a direction that would reduce this error: <span class="math notranslate nohighlight">\(\Delta w_j = \eta e^{(i)} x_j^{(i)}\)</span>.</p></li>
<li><p>The parameter <span class="math notranslate nohighlight">\(\eta\)</span> is called the <em>learning rate</em>.</p></li>
</ul>
<p>This learning algorithm is a variant of <em>stochastic learning</em>.</p>
<p>Alternatively, one can perform <em>batch learning</em> for which multiple instances are combined into a batch, and the weights are adjusted following the matrix expression stated above. One can then repeat the training multiple times where each iteration consists of a <em>forward pass</em> (computing the outputs <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> given a set of weights <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span>) and <em>back-propagation</em> in which the gradient is computed and the weights are adjusted. At the end, one hopes to have reached an optimal set of weights.</p>
<!-- !split -->
<div class="section" id="extending-to-more-predictors">
<h4>Extending to more predictors<a class="headerlink" href="#extending-to-more-predictors" title="Permalink to this headline">¶</a></h4>
<p>Within a binary classification problem, we can easily expand our model to include multiple predictors. Our activation function is then (with <span class="math notranslate nohighlight">\(p\)</span> predictors)</p>
<div class="math notranslate nohighlight">
\[a( \boldsymbol{x}^{(i)}, \boldsymbol{w} ) = w_0 + w_1 x_1^{(i)} + w_2 x_2^{(i)} + \dots + w_p x_p^{(i)}.\]</div>
<p>Defining <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)} \equiv [1,x_1^{(i)}, x_2^{(i)}, \dots, x_p^{(i)}]\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{w}=[w_0, w_1, \dots, w_p]\)</span> we get</p>
<div class="math notranslate nohighlight">
\[p(t^{(i)}=1 | \boldsymbol{w}, \boldsymbol{x}^{(i)}) = \frac{ \exp{ \left( \boldsymbol{w} \cdot \boldsymbol{x}^{(i)} \right) }}{ 1 + \exp{ \left( \boldsymbol{w} \cdot \boldsymbol{x}^{(i)} \right) } }.\]</div>
<!-- !split -->
</div>
</div>
</div>
<div class="section" id="including-more-classes">
<h2><span class="section-number">31.4. </span>Including more classes<a class="headerlink" href="#including-more-classes" title="Permalink to this headline">¶</a></h2>
<p>Until now we have mainly focused on two classes, the so-called binary
system. Suppose we wish to extend to <span class="math notranslate nohighlight">\(K\)</span> classes.  We will then need to have <span class="math notranslate nohighlight">\(K-1\)</span> outputs <span class="math notranslate nohighlight">\(\boldsymbol{y}^{(i)} = \{ y_1^{(i)}, y_2^{(i)}, \ldots, y_{K-1}^{(i)} \}\)</span>.</p>
<p><em>Question.</em>
Why do we need only <span class="math notranslate nohighlight">\(K-1\)</span> outputs if there are <span class="math notranslate nohighlight">\(K\)</span> classes?</p>
<p>Let us for the sake of simplicity assume we have only one independent (inout) variable. The activation functions for the outputs are (suppressing the index <span class="math notranslate nohighlight">\(i\)</span>)</p>
<div class="math notranslate nohighlight">
\[a_1 = w_{1,0}+w_{1,1}x_1,\]</div>
<div class="math notranslate nohighlight">
\[a_2 = w_{2,0}+w_{2,1}x_1,\]</div>
<p>and so on until the class <span class="math notranslate nohighlight">\(C=K-1\)</span> class</p>
<div class="math notranslate nohighlight">
\[a_{K-1} = w_{(K-1),0}+w_{(K-1),1}x_1,\]</div>
<p>and the model is specified in term of <span class="math notranslate nohighlight">\(K-1\)</span> so-called log-odds or <strong>logit</strong> transformations <span class="math notranslate nohighlight">\(y_j^{(i)} = y(a_j^{(i)})\)</span>.</p>
<!-- !split -->
<div class="section" id="class-probabilities-the-softmax-function">
<h3>Class probabilities: The Softmax function<a class="headerlink" href="#class-probabilities-the-softmax-function" title="Permalink to this headline">¶</a></h3>
<p>The transformation of the multiple outputs, as described above, to probabilities for belonging to any of <span class="math notranslate nohighlight">\(K\)</span> different classes can be achieved via the so-called <em>Softmax</em> function.</p>
<p>The Softmax function is used in various multiclass classification
methods, such as multinomial logistic regression (also known as
softmax regression), multiclass linear discriminant analysis, naive
Bayes classifiers, and artificial neural networks.  Specifically, the predicted probability for the <span class="math notranslate nohighlight">\(k\)</span>-th class given a sample
vector <span class="math notranslate nohighlight">\(\boldsymbol{x}^{(i)}\)</span> and a weighting vector <span class="math notranslate nohighlight">\(\boldsymbol{w}\)</span> is (with one independent variable):</p>
<div class="math notranslate nohighlight">
\[p(t^{(i)}=k\vert \boldsymbol{x}^{(i)},  \boldsymbol{w} ) = \frac{\exp{(w_{k,0}+w_{k,1}x_1^{(i)})}} {1+\sum_{l=1}^{K-1}\exp{(w_{l,0}+w_{l,1}x_1^{(i)})}}.\]</div>
<p>It is easy to extend to more predictors. The probability for the final class is</p>
<div class="math notranslate nohighlight">
\[p(t^{(i)}=K\vert \boldsymbol{x}^{(i)},  \boldsymbol{w} ) = \frac{1} {1+\sum_{l=1}^{K-1}\exp{(w_{l,0}+w_{l,1}x_1^{(i)})}},\]</div>
<p>which means that the discrete set of probabilities is properly normalized.</p>
<p>Our earlier discussions were all specialized to
the case with two classes only. It is easy to see from the above that
what we derived earlier is compatible with these equations.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "physics-chalmers/tif285",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/MachineLearning/LogReg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../GP/exercise_GP.html" title="previous page"><span class="section-number">30. </span>Exercise: Gaussian processes</a>
    <a class='right-next' id="next-link" href="../NeuralNet/NeuralNet.html" title="next page"><span class="section-number">32. </span>Neural networks</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Christian Forssén<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>