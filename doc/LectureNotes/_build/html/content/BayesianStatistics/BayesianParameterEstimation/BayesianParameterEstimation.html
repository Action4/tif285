
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>14. Inference With Parametric Models &#8212; Learning from data</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="15. Bayesian parameter estimation demonstration" href="demo-BayesianParameterEstimation.html" />
    <link rel="prev" title="13. Checking the sum and product rules, and their consequences" href="../BayesianBasics/exercise_sum_product_rule.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learning from data</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/welcome.html">
   Course aim
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/Intro.html">
   1. Learning from data: Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/demo-Intro.html">
   2. Reading Data and fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/exercise_Jupyter_Python_intro_01.html">
   3. Python and Jupyter notebooks: part 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Intro/exercise_Jupyter_Python_intro_02.html">
   4. Python and Jupyter notebooks: part 02
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Linear regression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/LinearRegression.html">
   5. Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/ModelValidation.html">
   6. Model validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/GradientDescent.html">
   7. Gradient-descent optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/demo-ModelValidation.html">
   8. Linear Regression and Model Validation demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LinearRegression/exercise_LinearRegression.html">
   9. Linear Regression exercise
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Bayesian statistics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../BayesianBasics/BayesianBasics.html">
   10. Statistical inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BayesianBasics/BayesianRecipe.html">
   11. The Bayesian recipe
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BayesianBasics/demo-BayesianBasics.html">
   12. Interactive Bayesian Coin Tossing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../BayesianBasics/exercise_sum_product_rule.html">
   13. Checking the sum and product rules, and their consequences
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   14. Inference With Parametric Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="demo-BayesianParameterEstimation.html">
   15. Bayesian parameter estimation demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exercise_BayesianParameterEstimation.html">
   16. Exercise: Bayesian parameter estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MCMC/MCMC.html">
   17. Why MCMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MCMC/demo-MCMC.html">
   18. Metropolis-Hasting MCMC sampling of a Poisson distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ErrorPropagation/ErrorPropagation.html">
   19. Why Bayes is Better
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ErrorPropagation/demo-ErrorPropagation.html">
   20. Learning from Data: Error propagation and nuisance parameters (demonstration)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MaxEnt/IgnorancePDF.html">
   21. Ignorance pdfs: Indifference and translation groups
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MaxEnt/MaxEnt.html">
   22. The principle of maximum entropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MaxEnt/demo-MaxEnt.html">
   23. Assigning probabilities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ModelSelection/ModelSelection.html">
   24. Model Selection
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine learning-A Bayesian perspective
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/GP/GaussianProcesses.html">
   25. Gaussian processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/GP/demo-GaussianProcesses.html">
   26. Gaussian processes demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/GP/exercise_GP.html">
   27. Exercise: Gaussian processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/LogReg/LogReg.html">
   28. Logistic Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/NeuralNet/NeuralNet.html">
   29. Neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/NeuralNet/demo-NeuralNet.html">
   30. Neural network classifier demonstration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/NeuralNet/exercises_LogReg_NeuralNet.html">
   31. Exercise: Logistic Regression and neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/CNN/cnn.html">
   32. Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/CNN/demo-cnn.html">
   33. Image recognition demonstration with Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/BNN/bnn.html">
   34. Bayesian neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/BNN/demo-bnn.html">
   35. Variational Inference: Bayesian Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../MachineLearning/BNN/exercises_BNN.html">
   36. Exercise: Bayesian neural networks
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/BayesianStatistics/BayesianParameterEstimation/BayesianParameterEstimation.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/physics-chalmers/tif285"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/physics-chalmers/tif285/issues/new?title=Issue%20on%20page%20%2Fcontent/BayesianStatistics/BayesianParameterEstimation/BayesianParameterEstimation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameter-estimation">
   14.1. Parameter estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bayesian-parameter-estimation">
     Bayesian parameter estimation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-measured-flux-from-a-star-single-parameter">
   14.2. Example: Measured flux from a star (single parameter)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-photon-counts-frequentist-approach">
     Simple Photon Counts: Frequentist Approach
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-photon-counts-bayesian-approach">
     Simple Photon Counts: Bayesian Approach
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-note-about-priors">
     A note about priors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-photon-counts-bayesian-approach-in-practice">
     Simple Photon Counts: Bayesian approach in practice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aside-best-estimates-and-credible-intervals">
     Aside: Best estimates and credible intervals
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#symmetric-posterior-pdfs">
       Symmetric posterior pdfs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#asymmetric-posterior-pdfs">
       Asymmetric posterior pdfs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multimodal-posterior-pdfs">
       Multimodal posterior pdfs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#different-views-on-credible-confidence-intervals">
       Different views on credible/confidence intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-photon-counts-best-estimates-and-credible-intervals">
     Simple Photon Counts: Best estimates and credible intervals
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-gaussian-noise-and-averages">
   14.3. Example: Gaussian noise and averages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-fitting-a-straight-line">
   14.4. Example: Fitting a straight line
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-regression-revisited">
     Linear regression revisited
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-normal-distributions">
     Why normal distributions?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlations">
     Correlations
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- !split -->
<!-- <img src="fig/BayesianParameterEstimation/m1m2.png" width=400><p><em>Joint pdf for the masses of two black holes merging obtained from the data analysis of a gravitational wave signal. This representation of a joint pdf is known as a corner plot. <div id="fig:gw"></div></em></p> -->
<p><img alt="Joint pdf for the masses of two black holes merging obtained from the data analysis of a gravitational wave signal. This representation of a joint pdf is known as a corner plot. " src="../../../_images/m1m2.png" /></p>
<!-- !split -->
<div class="section" id="inference-with-parametric-models">
<h1><span class="section-number">14. </span>Inference With Parametric Models<a class="headerlink" href="#inference-with-parametric-models" title="Permalink to this headline">¶</a></h1>
<p>Inductive inference with parametric models is a very important tool in the natural sciences.</p>
<ul class="simple">
<li><p>Consider <span class="math notranslate nohighlight">\(N\)</span> different models <span class="math notranslate nohighlight">\(M_i\)</span> (<span class="math notranslate nohighlight">\(i = 1, \ldots, N\)</span>), each with a parameter vector <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_i\)</span>. The number of parameters (length of <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_i\)</span>) might be different for different models. Each of them implies a sampling distribution for possible data</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(D|\boldsymbol{\theta}_i, M_i)\]</div>
<ul class="simple">
<li><p>The likelihood function is the pdf of the actual, observed data (<span class="math notranslate nohighlight">\(D_\mathrm{obs}\)</span>) given a set of parameters <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_i\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{L}_i (\boldsymbol{\theta}_i) \equiv p(D_\mathrm{obs}|\boldsymbol{\theta}_i, M_i)\]</div>
<ul class="simple">
<li><p>We may be uncertain about <span class="math notranslate nohighlight">\(M_i\)</span> (model uncertainty),</p></li>
<li><p>or uncertain about <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_i\)</span> (parameter uncertainty).</p></li>
</ul>
<!-- !split -->
<div class="tip admonition">
<p class="admonition-title">Parameter Estimation:</p>
<p>Premise = We have chosen a model (say <span class="math notranslate nohighlight">\(M_1\)</span>)</p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> What can we say about its parameters <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_1\)</span>?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Model comparison:</p>
<p>Premise = We have a set of different models <span class="math notranslate nohighlight">\(\{M_i\}\)</span></p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> How do they compare with each other? Do we have evidence to say that, e.g. <span class="math notranslate nohighlight">\(M_1\)</span>, is better than <span class="math notranslate nohighlight">\(M_2\)</span>?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Model adequacy:</p>
<p>Premise = We have a model <span class="math notranslate nohighlight">\(M_1\)</span></p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> Is <span class="math notranslate nohighlight">\(M_1\)</span> adequate?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Hybrid Uncertainty:</p>
<p>Models share some common params: <span class="math notranslate nohighlight">\(\boldsymbol{\theta}_i = \{ \boldsymbol{\varphi}, \boldsymbol{\eta}_i\}\)</span></p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> What can we say about <span class="math notranslate nohighlight">\(\boldsymbol{\varphi}\)</span>? (Systematic error is an example)</p>
</div>
<!-- !split -->
<div class="section" id="parameter-estimation">
<h2><span class="section-number">14.1. </span>Parameter estimation<a class="headerlink" href="#parameter-estimation" title="Permalink to this headline">¶</a></h2>
<p>Overview comments:</p>
<ul class="simple">
<li><p>In general terms, “parameter estimation” in physics means obtaining values for parameters (constants) that appear in a theoretical model which describes data (exceptions to this general definition exist of course).</p></li>
<li><p>Conventionally this process is known as “parameter fitting” and very often the goal is just to find the “best fit”.</p></li>
<li><p>We will interpret this task from our Bayesian point of view.</p></li>
<li><p>In particular, our ambition is larger as we realize that the strength of inference is best expressed via probabilities (or pdf:s).</p></li>
<li><p>We will also see how familiar ideas like “least-squares optimization” show up from a Bayesian perspective.</p></li>
</ul>
<!-- !split -->
<div class="section" id="bayesian-parameter-estimation">
<h3>Bayesian parameter estimation<a class="headerlink" href="#bayesian-parameter-estimation" title="Permalink to this headline">¶</a></h3>
<p>We will now consider the Bayesian approach to the very important task of model parameter estimation using statistical inference.</p>
<p>Let us first remind ourselves what can go wrong in a fit. We have encountered both <strong>underfitting</strong> (model is not complex enough to describe the variability in the data) and <strong>overfitting</strong> (model tunes to data fluctuations, or terms are underdetermined causing them playing off each other). Bayesian methods can prevent/identify both these situations.</p>
<!-- !split -->
<!-- ===== Example: Measured flux from a star (single parameter) ===== -->
</div>
</div>
<div class="section" id="example-measured-flux-from-a-star-single-parameter">
<h2><span class="section-number">14.2. </span>Example: Measured flux from a star (single parameter)<a class="headerlink" href="#example-measured-flux-from-a-star-single-parameter" title="Permalink to this headline">¶</a></h2>
<p>Adapted from the blog <a class="reference external" href="http://jakevdp.github.io">Pythonic Perambulations</a> by Jake VanderPlas.</p>
<p>Imagine that we point our telescope to the sky, and observe the light coming from a single star. Our physics model will be that the star’s true flux is constant with time, i.e. that  it has a fixed value <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span> (we’ll also ignore effects like sky noise and other sources of systematic error). Thus, we have a single model parameter: <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>.</p>
<p>We’ll assume that we perform a series of <span class="math notranslate nohighlight">\(N\)</span> measurements with our telescope, where the i:th measurement reports an observed photon flux <span class="math notranslate nohighlight">\(F_i\)</span> and is accompanied by an error model given by <span class="math notranslate nohighlight">\(e_i\)</span><a class="footnote-reference brackets" href="#errors" id="id1">1</a>.
The question is, given this set of measurements <span class="math notranslate nohighlight">\(D = \{F_i\}_{i=0}^{N-1}\)</span>, and the statistical model <span class="math notranslate nohighlight">\(F_i = F_\mathrm{true} + e_i\)</span>, what is our best estimate of the true flux <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>?</p>
<p>Because the measurements are number counts, a Poisson distribution is a good approximation to the measurement process:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">emcee</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># for repeatability</span>
<span class="n">F_true</span> <span class="o">=</span> <span class="mi">1000</span>          <span class="c1"># true flux, say number of photons measured in 1 second</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>                 <span class="c1"># number of measurements</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">F_true</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
                       <span class="c1"># N measurements of the flux</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>         <span class="c1"># errors on Poisson counts estimated via square root</span>
</pre></div>
</div>
<p>Now let’s make a simple visualization of the “observed” data, see Fig. <a class="reference external" href="#fig:flux">fig:flux</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">xerr</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="n">F_true</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Flux&quot;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;measurement number&quot;</span><span class="p">);</span>
</pre></div>
</div>
<!-- <img src="fig/BayesianParameterEstimation/singlephotoncount_fig_1.png" width=400><p><em>Single photon counts (flux measurements). <div id="fig:flux"></div></em></p> -->
<p><img alt="Single photon counts (flux measurements). " src="../../../_images/singlephotoncount_fig_1.png" /></p>
<p>These measurements each have a different error <span class="math notranslate nohighlight">\(e_i\)</span> which is estimated from Poisson statistics using the standard square-root rule. In this toy example we know the true flux that was used to generate the data, but the question is this: given our measurements and statistical model, what is our best estimate of <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>?</p>
<p>Let’s take a look at the frequentist and Bayesian approaches to solving this.</p>
<div class="section" id="simple-photon-counts-frequentist-approach">
<h3>Simple Photon Counts: Frequentist Approach<a class="headerlink" href="#simple-photon-counts-frequentist-approach" title="Permalink to this headline">¶</a></h3>
<p>We’ll start with the classical frequentist maximum likelihood approach. Given a single observation <span class="math notranslate nohighlight">\(D_i = F_i\)</span>, we can compute the probability distribution of the measurement given the true flux <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span> and our assumption of Gaussian errors</p>
<div class="amsmath math notranslate nohighlight" id="equation-56279af5-a95e-46f5-803f-c6a0fbd2b4bf">
<span class="eqno">(14.1)<a class="headerlink" href="#equation-56279af5-a95e-46f5-803f-c6a0fbd2b4bf" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p(D_i | F_\mathrm{true}, I) = \frac{1}{\sqrt{2\pi e_i^2}} \exp \left( \frac{-(F_i-F_\mathrm{true})^2}{2e_i^2} \right).
\end{equation}\]</div>
<p>This should be read “the probability of <span class="math notranslate nohighlight">\(D_i\)</span> given <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>
equals …”. You should recognize this as a normal distribution with mean <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span> and standard deviation <span class="math notranslate nohighlight">\(e_i\)</span>.</p>
<p>We construct the <em>likelihood function</em> by computing the product of the probabilities for each data point</p>
<div class="amsmath math notranslate nohighlight" id="equation-b1894a16-27e0-488e-ba30-40f1972787ba">
<span class="eqno">(14.2)<a class="headerlink" href="#equation-b1894a16-27e0-488e-ba30-40f1972787ba" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathcal{L}(F_\mathrm{true}) = \prod_{i=1}^N p(D_i | F_\mathrm{true}, I),
\end{equation}\]</div>
<p>here <span class="math notranslate nohighlight">\(D = \{D_i\}\)</span> represents the entire set of measurements. Because the value of the likelihood can become very small, it is often more convenient to instead compute the log-likelihood.</p>
<p><em>Notice.</em>
In the following we will use <span class="math notranslate nohighlight">\(\log\)</span> to denote the natural logarithm. We will write <span class="math notranslate nohighlight">\(\log_{10}\)</span> if we specifically mean the logarithm with base 10.</p>
<p>Combining the previous two equations and computing the log, we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-f1e36aba-a46c-4174-af1f-68981e099f39">
<span class="eqno">(14.3)<a class="headerlink" href="#equation-f1e36aba-a46c-4174-af1f-68981e099f39" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\log\mathcal{L} = -\frac{1}{2} \sum_{i=1}^N \left[ \log(2\pi e_i^2) +  \frac{(F_i-F_\mathrm{true})^2}{e_i^2} \right].
\end{equation}\]</div>
<p>In this approach we will determine <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span> such that the likelihood is maximized. At this pont we can note that that problem of maximizing the likelihood is equivalent to the minimization of the sum</p>
<div class="amsmath math notranslate nohighlight" id="equation-5cbc43d4-a9ad-4f86-aa4a-014253e2a3d6">
<span class="eqno">(14.4)<a class="headerlink" href="#equation-5cbc43d4-a9ad-4f86-aa4a-014253e2a3d6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\sum_{i=1}^N \frac{(F_i-F_\mathrm{true})^2}{e_i^2},
\end{equation}\]</div>
<p>which you should recognize as the chi-squared function encountered in the linear regression model.</p>
<p>Therefore, it is not surprising that this particular maximization problem can be solved analytically (i.e. by setting <span class="math notranslate nohighlight">\(d\log\mathcal{L}/d F_\mathrm{true} = 0\)</span>). This results in the following observed estimate of <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-edd4f3a2-61ee-4ba8-ad3b-4757503bdf7c">
<span class="eqno">(14.5)<a class="headerlink" href="#equation-edd4f3a2-61ee-4ba8-ad3b-4757503bdf7c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
F_\mathrm{est} = \frac{ \sum_{i=1}^N w_i F_i }{ \sum_{i=1}^N w_i}, \quad w_i = 1/e_i^2.
\end{equation}\]</div>
<p>Notice that in the special case of all errors <span class="math notranslate nohighlight">\(e_i\)</span> being equal, this reduces to</p>
<div class="amsmath math notranslate nohighlight" id="equation-0ac64815-f7ce-4c9e-b3fd-e4d1865a23c6">
<span class="eqno">(14.6)<a class="headerlink" href="#equation-0ac64815-f7ce-4c9e-b3fd-e4d1865a23c6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
F_\mathrm{est} = \frac{1}{N} \sum_{i=1} F_i.
\end{equation}\]</div>
<p>That is, in agreement with intuition, <span class="math notranslate nohighlight">\(F_\mathrm{est}\)</span> is simply the mean of the observed data when errors are equal.</p>
<p>We can go further and ask what the error of our estimate is. In the frequentist approach, this can be accomplished by fitting a Gaussian approximation to the likelihood curve at maximum; in this simple case this can also be solved analytically (the sum of Gaussians is also a Gaussian). It can be shown that the standard deviation of this Gaussian approximation is <span class="math notranslate nohighlight">\(\sigma_\mathrm{est}\)</span>, which is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-68526da7-9589-40a8-8c25-3a25b250cc84">
<span class="eqno">(14.7)<a class="headerlink" href="#equation-68526da7-9589-40a8-8c25-3a25b250cc84" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{ 1 } {\sigma_\mathrm{est}^2} = \sum_{i=1}^N w_i .
\end{equation}\]</div>
<p>These results are fairly simple calculations; let’s evaluate them for our toy dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">F_true = </span><span class="si">{</span><span class="n">F_true</span><span class="si">}</span><span class="s2"></span>
<span class="s2">F_est = </span><span class="si">{</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">**</span> <span class="o">-</span><span class="mf">0.5</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> (based on </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2"> measurements) &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">F_true</span> <span class="pre">=</span> <span class="pre">1000</span></code> <br/>
<code class="docutils literal notranslate"><span class="pre">F_est</span> <span class="pre">=</span> <span class="pre">998</span> <span class="pre">+/-</span> <span class="pre">4</span> <span class="pre">(based</span> <span class="pre">on</span> <span class="pre">50</span> <span class="pre">measurements)</span></code> <br/></p>
<p>We find that for 50 measurements of the flux, our estimate has an error of about 0.4% and is consistent with the input value.</p>
</div>
<div class="section" id="simple-photon-counts-bayesian-approach">
<h3>Simple Photon Counts: Bayesian Approach<a class="headerlink" href="#simple-photon-counts-bayesian-approach" title="Permalink to this headline">¶</a></h3>
<p>The Bayesian approach, as you might expect, begins and ends with probabilities. Our hypothesis is that the star has a constant flux <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>. It recognizes that what we fundamentally want to compute is our knowledge of the parameter in question given the data and other information (such as our knowledge of uncertainties for the observed values), i.e. in this case, <span class="math notranslate nohighlight">\(p(F_\mathrm{true} | D,I)\)</span>.
Note that this formulation of the problem is fundamentally contrary to the frequentist philosophy, which says that probabilities have no meaning for model parameters like <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>. Nevertheless, within the Bayesian philosophy this is perfectly acceptable.</p>
<p>To compute this pdf, Bayesians next apply Bayes’ Theorem.
If we set the prior <span class="math notranslate nohighlight">\(p(F_\mathrm{true}|I) \propto 1\)</span> (a flat prior), we find
<span class="math notranslate nohighlight">\(p(F_\mathrm{true}|D,I) \propto p(D | F_\mathrm{true},I) \equiv \mathcal{L}(F_\mathrm{true})\)</span>
and the Bayesian probability is maximized at precisely the same value as the frequentist result! So despite the philosophical differences, we see that (for this simple problem at least) the Bayesian and frequentist point estimates are equivalent.</p>
</div>
<div class="section" id="a-note-about-priors">
<h3>A note about priors<a class="headerlink" href="#a-note-about-priors" title="Permalink to this headline">¶</a></h3>
<p>The prior allows inclusion of other information into the computation, which becomes very useful in cases where multiple measurement strategies are being combined to constrain a single model. The necessity to specify a prior, however, is one of the more controversial pieces of Bayesian analysis.
A frequentist will point out that the prior is problematic when no true prior information is available. Though it might seem straightforward to use a noninformative prior like the flat prior mentioned above, there are some [surprisingly subtleties](http://normaldeviate.wordpress.com/2013/07/13/lost-causes-in-statistics-ii-noninformative- priors/comment-page-1/) involved. It turns out that in many situations, a truly noninformative prior does not exist! Frequentists point out that the subjective choice of a prior which necessarily biases your result has no place in statistical data analysis.
A Bayesian would counter that frequentism doesn’t solve this problem, but simply skirts the question. Frequentism can often be viewed as simply a special case of the Bayesian approach for some (implicit) choice of the prior: a Bayesian would say that it’s better to make this implicit choice explicit, even if the choice might include some subjectivity.</p>
</div>
<div class="section" id="simple-photon-counts-bayesian-approach-in-practice">
<h3>Simple Photon Counts: Bayesian approach in practice<a class="headerlink" href="#simple-photon-counts-bayesian-approach-in-practice" title="Permalink to this headline">¶</a></h3>
<p>Leaving these philosophical debates aside for the time being, let’s address how Bayesian results are generally computed in practice. For a one parameter problem like the one considered here, it’s as simple as computing the posterior probability <span class="math notranslate nohighlight">\(p(F_\mathrm{true} | D,I)\)</span> as a function of <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>: this is the distribution reflecting our knowledge of the parameter <span class="math notranslate nohighlight">\(F_\mathrm{true}\)</span>.
But as the dimension of the model grows, this direct approach becomes increasingly intractable. For this reason, Bayesian calculations often depend on sampling methods such as Markov Chain Monte Carlo (MCMC). For this practical example, let us apply an MCMC approach using Dan Foreman-Mackey’s <a class="reference external" href="http://dan.iel.fm/emcee/current/">emcee</a> package. Keep in mind here that the goal is to generate a set of points drawn from the posterior probability distribution, and to use those points to determine the answer we seek.
To perform this MCMC, we start by defining Python functions for the prior <span class="math notranslate nohighlight">\(p(F_\mathrm{true} | I)\)</span>, the likelihood <span class="math notranslate nohighlight">\(p(D | F_\mathrm{true},I)\)</span>, and the posterior <span class="math notranslate nohighlight">\(p(F_\mathrm{true} | D,I)\)</span>, noting that none of these need be properly normalized. Our model here is one-dimensional, but to handle multi-dimensional models we’ll define the model in terms of an array of parameters <span class="math notranslate nohighlight">\(\boldsymbol{\theta}\)</span>, which in this case is <span class="math notranslate nohighlight">\(\boldsymbol{\theta} = [F_\mathrm{true}]\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">log_prior</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">theta</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">theta</span><span class="o">&lt;</span><span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="c1"># flat prior</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">def</span> <span class="nf">log_likelihood</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> \ 
                             <span class="o">+</span> <span class="p">(</span><span class="n">F</span> <span class="o">-</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                             
<span class="k">def</span> <span class="nf">log_posterior</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">log_prior</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we set up the problem, including generating some random starting guesses for the multiple chains of points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c1"># number of parameters in the model</span>
<span class="n">nwalkers</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># number of MCMC walkers</span>
<span class="n">nwarm</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># &quot;warm-up&quot; period to let chains stabilize</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">2000</span> <span class="c1"># number of MCMC steps to take</span>
<span class="c1"># we&#39;ll start at random locations between 0 and 2000</span>
<span class="n">starting_guesses</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">emcee</span><span class="o">.</span><span class="n">EnsembleSampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">log_posterior</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">e</span><span class="p">])</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">starting_guesses</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">)</span>
<span class="c1"># Shape of sampler.chain  = (nwalkers, nsteps, ndim)</span>
<span class="c1"># Flatten the sampler chain and discard warm-in points:</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">chain</span><span class="p">[:,</span> <span class="n">nwarm</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>If this all worked correctly, the array sample should contain a series of 50,000 points drawn from the posterior. Let’s plot them and check. See results in Fig. <a class="reference external" href="#fig:flux-bayesian">fig:flux-bayesian</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s2">&quot;stepfilled&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$F_\mathrm</span><span class="si">{est}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p(F_\mathrm</span><span class="si">{est}</span><span class="s1">|D,I)$&#39;</span><span class="p">);</span>
</pre></div>
</div>
<!-- <img src="fig/BayesianParameterEstimation/singlephotoncount_fig_2.png" width=400><p><em>Bayesian posterior pdf (represented by a histogram of MCMC samples) from flux measurements. <div id="fig:flux-bayesian"></div></em></p> -->
<p><img alt="Bayesian posterior pdf (represented by a histogram of MCMC samples) from flux measurements. " src="../../../_images/singlephotoncount_fig_2.png" /></p>
<!-- !split -->
</div>
<div class="section" id="aside-best-estimates-and-credible-intervals">
<h3>Aside: Best estimates and credible intervals<a class="headerlink" href="#aside-best-estimates-and-credible-intervals" title="Permalink to this headline">¶</a></h3>
<p>The posterior distribution from our Bayesian data analysis is the key quantity that encodes our inference about the values of the model parameters, given the data and the relevant background information. Often, however, we wish to summarize this result with just a few numbers: the best estimate and a measure of its reliability.</p>
<p>There are a few different options for this. The choice of the most appropriate one depends mainly on the shape of the posterior distribution:</p>
<!-- !split -->
<div class="section" id="symmetric-posterior-pdfs">
<h4>Symmetric posterior pdfs<a class="headerlink" href="#symmetric-posterior-pdfs" title="Permalink to this headline">¶</a></h4>
<p>Since the probability (density) associated with any particular value of the parameter is a measure of how much we believe that it lies in the neighbourhood of that point, our best estimate is given by the maximum of the posterior pdf. If we denote the quantity of interest by <span class="math notranslate nohighlight">\(\theta\)</span>, with a posterior pdf <span class="math notranslate nohighlight">\(P =p(\theta|D,I)\)</span>, then the best estimate of its value <span class="math notranslate nohighlight">\(\theta_0\)</span> is given by the condition <span class="math notranslate nohighlight">\(dP/d\theta|_{\theta=\theta_0}=0\)</span>. Strictly speaking, we should also check the sign of the second derivative to ensure that <span class="math notranslate nohighlight">\(\theta_0\)</span> represents a maximum.</p>
<p>To obtain a measure of the reliability of this best estimate, we need to look at the width or spread of the posterior pdf about <span class="math notranslate nohighlight">\(\theta_0\)</span>. When considering the behaviour of any function in the neighbourhood of a particular point, it is often helpful to carry out a Taylor series expansion; this is simply a standard tool for (locally) approximating a complicated function by a low-order polynomial. The linear term is zero at the maximum and the quadratic term is often the dominating one determining the width of the posterior pdf. Ignoring all the higher-order terms we arrive at the Gaussian approximation (see more details below)</p>
<div class="amsmath math notranslate nohighlight" id="equation-7c4c8269-5439-4d3a-a3b8-4b9f409b19f0">
<span class="eqno">(14.8)<a class="headerlink" href="#equation-7c4c8269-5439-4d3a-a3b8-4b9f409b19f0" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p(\theta|D,I) \approx \frac{1}{\sigma\sqrt{2\pi}} \exp \left[ -\frac{(\theta-\mu)^2}{2\sigma^2} \right],
\end{equation}\]</div>
<p>where the mean <span class="math notranslate nohighlight">\(\mu = \theta_0\)</span> and the variance <span class="math notranslate nohighlight">\(\sigma = \left( - \left. \frac{d^2L}{d\theta^2} \right|_{\theta_0} \right)^{-1/2}\)</span>, where <span class="math notranslate nohighlight">\(L\)</span> is the logarithm of the posterior <span class="math notranslate nohighlight">\(P\)</span>. Our inference about the quantity of interest is conveyed very concisely, therefore, by the 67% Bayesian credible interval <span class="math notranslate nohighlight">\(\theta = \theta_0 \pm \sigma\)</span>, and</p>
<div class="math notranslate nohighlight">
\[
p(\theta_0-\sigma &lt; \theta &lt; \theta_0+\sigma | D,I) = \int_{\theta_0-\sigma}^{\theta_0+\sigma} p(\theta|D,I) d\theta \approx 0.67.
\]</div>
<!-- !split -->
</div>
<div class="section" id="asymmetric-posterior-pdfs">
<h4>Asymmetric posterior pdfs<a class="headerlink" href="#asymmetric-posterior-pdfs" title="Permalink to this headline">¶</a></h4>
<p>While the maximum (mode) of the posterior (<span class="math notranslate nohighlight">\(\theta_0\)</span>) can still be regarded as giving the best estimate, the integrated probability mass is larger on one side of this rather than the other. Alternatively one can compute the mean value, <span class="math notranslate nohighlight">\(\langle \theta \rangle = \int \theta p(\theta|D,I) d\theta\)</span>, although this tends to overemphasise very long tails. The best option is probably a compromise that can be employed when having access to a large sample from the posterior (as provided by an MCMC), namely to give the median of this ensemble.</p>
<p>Furthermore, the concept of a single error bar does not seem appropriate in this case, as it implicitly entails the idea of symmetry. A good way of expressing the reliability with which a parameter can be inferred, for an asymmetric posterior pdf, is rather through a <em>credible interval</em>. Since the area under the posterior pdf between <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> is proportional to how much we believe that <span class="math notranslate nohighlight">\(\theta\)</span> lies in that range, the shortest interval that encloses 67% of the area represents a sensible measure of the uncertainty of the estimate. Obviously we can choose to provide some other degree-of-belief that we think is relevant for the case at hand. Assuming that the posterior pdf has been normalized, to have unit area, we need to find <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[
p(\theta_1 &lt; \theta &lt; \theta_2 | D,I) = \int_{\theta_1}^{\theta_2} p(\theta|D,I) d\theta \approx 0.67, 
\]</div>
<p>where the difference <span class="math notranslate nohighlight">\(\theta_2 - \theta_1\)</span> is as small as possible. The region <span class="math notranslate nohighlight">\(\theta_1 &lt; \theta &lt; \theta_2\)</span> is then called a 67% credible interval.</p>
<!-- !split -->
</div>
<div class="section" id="multimodal-posterior-pdfs">
<h4>Multimodal posterior pdfs<a class="headerlink" href="#multimodal-posterior-pdfs" title="Permalink to this headline">¶</a></h4>
<p>We can sometimes obtain posteriors which are multimodal; i.e. contains several disconnected regions with large probabilities. There is no difficulty when one of the maxima is very much larger than the others: we can simply ignore the subsidiary solutions, to a good approximation, and concentrate on the global maximum. The problem arises when there are several maxima of comparable magnitude. What do we now mean by a best estimate, and how should we quantify its reliability? The idea of a best estimate and an error-bar, or even a credible interval, is merely an attempt to summarize the posterior with just two or three numbers; sometimes this just can’t be done, and so these concepts are not valid. For the bimodal case we might be able to characterize the posterior in terms of a few numbers: two best estimates and their associated error-bars, or disjoint credible intervals. For a general multimodal pdf, the most honest thing we can do is just display the posterior itself.</p>
<p>Two options for assigning credible intervals to asymmetric and multimodal pdfs:</p>
<ul class="simple">
<li><p>Equal-tailed interval: the probability area above and below the interval are equal.</p></li>
<li><p>Highest posterior density (HPD) interval: The posterior density for any point within the interval is larger than the posterior density for any point outside the interval.</p></li>
</ul>
<!-- !split -->
</div>
<div class="section" id="different-views-on-credible-confidence-intervals">
<h4>Different views on credible/confidence intervals<a class="headerlink" href="#different-views-on-credible-confidence-intervals" title="Permalink to this headline">¶</a></h4>
<p>A Bayesian credible interval, or degree-of-belief (DOB) interval, is the following: Given this data and other information there is <span class="math notranslate nohighlight">\(d \%\)</span> probability that this interval contains the true value of the parameter. E.g. a 95% DOB interval implies that the Baysian data analyser would bet 20-to-1 that the true result is inside the interval.</p>
<!-- !split -->
<p>A frequentist 95% <em>confidence interval</em> should be understood as follows:
“There is a 95% probability that when I compute a confidence interval from data of this sort that he true value of the parameter will fall within the (hypothetical) space of observations”. So the parameter is fixed (no pdf) and the confidence interval is based on random sampling of data.</p>
<p>Let’s try again to understand this: If we make a large number of repeated samples, then 95% of the intervals extracted in this way will include the true value of the parameter.</p>
</div>
</div>
<div class="section" id="simple-photon-counts-best-estimates-and-credible-intervals">
<h3>Simple Photon Counts: Best estimates and credible intervals<a class="headerlink" href="#simple-photon-counts-best-estimates-and-credible-intervals" title="Permalink to this headline">¶</a></h3>
<p>To compute these numbers for our example, you would run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampper</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">83.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">F_true = </span><span class="si">{</span><span class="n">F_true</span><span class="si">}</span><span class="s2"></span>
<span class="s2">Based on </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2"> measurements the posterior point estimates are:</span>
<span class="s2">...F_est = </span><span class="si">{</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"></span>
<span class="s2">or using credibility intervals:</span>
<span class="s2">...F_est = </span><span class="si">{</span><span class="n">sampper</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">          (posterior median) </span>
<span class="s2">...F_est in [</span><span class="si">{</span><span class="n">sampper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sampper</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">] (67% credibility interval) </span>
<span class="s2">...F_est in [</span><span class="si">{</span><span class="n">sampper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sampper</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">] (95% credibility interval) &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">F_true</span> <span class="pre">=</span> <span class="pre">1000</span></code> <br/>
<code class="docutils literal notranslate"><span class="pre">Based</span> <span class="pre">on</span> <span class="pre">50</span> <span class="pre">measurements</span> <span class="pre">the</span> <span class="pre">posterior</span> <span class="pre">point</span> <span class="pre">estimates</span> <span class="pre">are:</span></code> <br/>
<code class="docutils literal notranslate"><span class="pre">...F_est</span> <span class="pre">=</span> <span class="pre">998</span> <span class="pre">+/-</span> <span class="pre">4</span></code> <br/>
<code class="docutils literal notranslate"><span class="pre">or</span> <span class="pre">using</span> <span class="pre">credibility</span> <span class="pre">intervals:</span></code> <br/>
<code class="docutils literal notranslate"><span class="pre">...F_est</span> <span class="pre">=</span> <span class="pre">998</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(posterior</span> <span class="pre">median)</span></code>  <br/>
<code class="docutils literal notranslate"><span class="pre">...F_est</span> <span class="pre">in</span> <span class="pre">[993,</span> <span class="pre">1002]</span> <span class="pre">(67%</span> <span class="pre">credibility</span> <span class="pre">interval)</span></code>  <br/>
<code class="docutils literal notranslate"><span class="pre">...F_est</span> <span class="pre">in</span> <span class="pre">[989,</span> <span class="pre">1006]</span> <span class="pre">(95%</span> <span class="pre">credibility</span> <span class="pre">interval)</span></code>  <br/></p>
<p>In this particular example, the posterior pdf is actually a Gaussian (since it is constructed as a product of Gaussians), and the mean and variance from the quadratic approximation will agree exactly with the frequentist approach.</p>
<p>From this final result you might come away with the impression that the Bayesian method is unnecessarily complicated, and in this case it certainly is. Using an MCMC sampler to characterize a one-dimensional normal distribution is a bit like using the Death Star to destroy a beach ball, but we did this here because it demonstrates an approach that can scale to complicated posteriors in many, many dimensions, and can provide nice results in more complicated situations where an analytic likelihood approach is not possible.</p>
<p>Furthermore, as data, prior information, and models grow in complexity, the two approaches can diverge greatly.</p>
<!-- !split -->
</div>
</div>
<div class="section" id="example-gaussian-noise-and-averages">
<h2><span class="section-number">14.3. </span>Example: Gaussian noise and averages<a class="headerlink" href="#example-gaussian-noise-and-averages" title="Permalink to this headline">¶</a></h2>
<p>The example in the demonstration notebook is from Sivia’s book. How do we infer the mean and standard deviation from <span class="math notranslate nohighlight">\(M\)</span> measurements <span class="math notranslate nohighlight">\(D \in \{ x_k \}_{k=0}^{M-1}\)</span> that should be distributed according to a normal distribution <span class="math notranslate nohighlight">\(p( D | \mu,\sigma,I)\)</span>?</p>
<!-- !split -->
<p>Start from Bayes theorem</p>
<div class="math notranslate nohighlight">
\[
p(\mu,\sigma | D, I) = \frac{p(D|\mu,\sigma,I) p(\mu,\sigma|I)}{p(D|I)}
\]</div>
<ul class="simple">
<li><p>Remind yourself about the names of the different terms.</p></li>
<li><p>It should become intuitive what the different probabilities (pdfs) describe.</p></li>
<li><p>Bayes theorem tells you how to flip from (hard-to-compute) <span class="math notranslate nohighlight">\(p(\mu,\sigma | D, I) \Leftrightarrow p(D|\mu,\sigma,I)\)</span> (easier-to-compute).</p></li>
</ul>
<!-- !split -->
<p>Aside on the denominator, which is known as the “data probability” or “marginalized likelihood” or “evidence”.</p>
<ul class="simple">
<li><p>With <span class="math notranslate nohighlight">\(\theta\)</span> denoting a general vector of parameters we must have</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
p(D|I) = \int d\theta p(D|\theta,I) p(\theta|I).
\]</div>
<ul class="simple">
<li><p>This integration (or marginalization) over all parameters is often difficult to perform.</p></li>
<li><p>Fortunately, for <strong>parameter estimation</strong> we don’t need <span class="math notranslate nohighlight">\(p(D|I)\)</span> since it doesn’t depend on <span class="math notranslate nohighlight">\(\theta\)</span>. We usually only need relative probabilities, or we can determine the normalization <span class="math notranslate nohighlight">\(N\)</span> after we have computed the unnormalized posterior</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
p(\theta | D,I) = \frac{1}{N} p(D|\theta,I) p(\theta|I).
\]</div>
<!-- !split -->
<p>If we use a uniform prior <span class="math notranslate nohighlight">\(p(\theta | I ) \propto 1\)</span> (in a finite volume), then the posterior is proportional to the <strong>likelihood</strong></p>
<div class="math notranslate nohighlight">
\[
p(\theta | D,I) \propto p(D|\theta,I) = \mathcal{L}(\theta)
\]</div>
<p>In this particular situation, the mode of the likelihood (which would correspond to the point estimate of maximum likelihood) is equivalent to the mode of the posterior pdf in the Bayesian analysis.</p>
<!-- !split -->
<p>The real use of the prior, however, is to include into the analysis any additional information that you might have. The prior statement makes such additional assumptions and information very explicit.</p>
<p>But how do we actually compute the posterior in practice. Most often we won’t be able to get an analytical expression, but we can sample the distribution using a method known as Markov Chain Monte Carlo (MCMC).</p>
<!-- !split -->
</div>
<div class="section" id="example-fitting-a-straight-line">
<h2><span class="section-number">14.4. </span>Example: Fitting a straight line<a class="headerlink" href="#example-fitting-a-straight-line" title="Permalink to this headline">¶</a></h2>
<p>The next example that we will study is the well known fit of a straight line.</p>
<ul class="simple">
<li><p>Here the theoretical model is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_\mathrm{th}(x; \theta) = m x + b,
\]</div>
<p>with parameters <span class="math notranslate nohighlight">\(\theta = [b,m]\)</span>.</p>
<ul class="simple">
<li><p>The statistical model for the data is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_{\mathrm{exp},i} = y_{\mathrm{th},i} + \delta y_{\mathrm{exp},i},
\]</div>
<p>where we often assume that the experimental errors are independent and normally distributed so that</p>
<div class="math notranslate nohighlight">
\[
y_i = \mathcal{N} \left( y_\mathrm{th}(x_i; \theta), e_i^2 \right).
\]</div>
<ul class="simple">
<li><p>Are independent errors always a good approximation?</p></li>
<li><p>An even better statistical model for theoretical models with a quantified, finite resolution would be</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
y_\mathrm{exp} = y_\mathrm{th} + \delta y_\mathrm{exp} + \delta y_\mathrm{th}.
\]</div>
<!-- !split -->
<div class="section" id="linear-regression-revisited">
<h3>Linear regression revisited<a class="headerlink" href="#linear-regression-revisited" title="Permalink to this headline">¶</a></h3>
<p>At this point it is instructive to revisit the linear regression method that we started out with. It corresponds to models that are linear in the parameters such that</p>
<div class="math notranslate nohighlight">
\[
y_\mathrm{th} = \sum_{j=0}^{p-1} \theta_j g_j(x),
\]</div>
<p>with <span class="math notranslate nohighlight">\(p\)</span> parameters and <span class="math notranslate nohighlight">\(g_j(x)\)</span> denoting the basis functions.</p>
<p>With a likelihood as before</p>
<div class="math notranslate nohighlight">
\[
p(D|\theta,I) = \prod_{i=0}^{N-1} \exp \left[ -\frac{\left(y_i - y_\mathrm{th}(x_i;\theta) \right)^2}{2\sigma_i^2} \right],
\]</div>
<p>and assuming a Gaussian prior with a single width <span class="math notranslate nohighlight">\(\sigma_\theta\)</span> on the parameters</p>
<div class="math notranslate nohighlight">
\[
p(\theta|I) \propto \prod_{j=0}^{p-1} \exp \left[ -\frac{\theta_j^2}{2\sigma_\theta^2} \right].
\]</div>
<p>We note that the prior can be written <span class="math notranslate nohighlight">\(\exp\left( -|\theta|^2 / 2 \sigma_\theta^2\right)\)</span>, such that the log (unnormalized) posterior becomes</p>
<div class="math notranslate nohighlight">
\[
\log \left[ p(\theta|D,I) \right] = -\frac{1}{2} \left[ \sum_{i=0}^{N-1} \left( \frac{ y_i - y_\mathrm{th}(x_i;\theta)}{\sigma_i}\right)^2 + \frac{|\theta|^2}{\sigma_\theta^2} \right].
\]</div>
<p>The mode of the posterior pdf occurs at the minimum of this log-posterior function. You might recognise it as the modified cost function that we introduced in a rather <em>ad hoc</em> fashion when implementing linear regression with Ridge regularisation.  From our Bayesian perspective, linear regression with Ridge regularisation corresponds to the maximum a posteriori (MAP) estimate with a Gaussian prior on the parameters.</p>
<!-- !split -->
</div>
<div class="section" id="why-normal-distributions">
<h3>Why normal distributions?<a class="headerlink" href="#why-normal-distributions" title="Permalink to this headline">¶</a></h3>
<p>Let us give a quick motivation why Gaussian distributions show up so often. Say that we have a pdf <span class="math notranslate nohighlight">\(p(\theta | D,I)\)</span>. Our best estimate from this pdf will be <span class="math notranslate nohighlight">\(\theta_0\)</span> where</p>
<div class="math notranslate nohighlight">
\[ 
\left. 
\frac{ \partial p }{ \partial \theta }
\right|_{\theta_0} = 0, \qquad
\left. \frac{ \partial^2 p }{ \partial \theta^2 }
\right|_{\theta_0} &lt; 0.
\]</div>
<p>The distribution usually varies very rapidly so we study <span class="math notranslate nohighlight">\(L(\theta) \equiv \log p\)</span> instead.
Near the peak, it behaves as</p>
<div class="math notranslate nohighlight">
\[
L(\theta) = L(\theta_0) + \frac{1}{2} \left. \frac{\partial^2 L}{\partial \theta^2} \right|_{\theta_0} \left( \theta - \theta_0 \right)^2 + \ldots,
\]</div>
<p>where the first-order term is zero since we are expanding around a maximum and <span class="math notranslate nohighlight">\(\partial L / \partial\theta = 0\)</span>.</p>
<!-- !split -->
<p>If we neglect higher-order terms we find that</p>
<div class="math notranslate nohighlight">
\[
p(\theta|D,I) \approx A \exp \left[ \frac{1}{2} \left. \frac{\partial^2 L}{\partial \theta^2} \right|_{\theta_0} \left( \theta - \theta_0 \right)^2  \right],
\]</div>
<p>which is a Gaussian <span class="math notranslate nohighlight">\(\mathcal{N}(\mu,\sigma^2)\)</span> with</p>
<div class="math notranslate nohighlight">
\[
\mu = \theta_0, \qquad \sigma^2 = \left( - \left. \frac{\partial^2 L}{\partial \theta^2} \right|_{\theta_0} \right)^{-1/2}.
\]</div>
<!-- !split -->
</div>
<div class="section" id="correlations">
<h3>Correlations<a class="headerlink" href="#correlations" title="Permalink to this headline">¶</a></h3>
<p>In the “fitting a straight-line” example you should find that the joint pdf for the slope and the intercept <span class="math notranslate nohighlight">\([m, b]\)</span> corresponds to a slanted ellipse. That result implies that the model parameters are <strong>correlated</strong>.</p>
<ul class="simple">
<li><p>Try to understand the correlation that you find in this example.</p></li>
</ul>
<p>Let us explore correlations by studying the behavior of the pdf at the maximum.
A Taylor expansion for a bivariate pdf <span class="math notranslate nohighlight">\(p(x,y)\)</span> around the mode <span class="math notranslate nohighlight">\((x_0,y_0)\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
p(x,y) \approx p(x_0,y_0) + \frac{1}{2} \begin{pmatrix} x-x_0 &amp; y-y_0 \end{pmatrix}
H
\begin{pmatrix} x-x_0 \\ y-y_0 \end{pmatrix},
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the symmetric Hessian matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
A &amp; C \\ C &amp; B
\end{pmatrix}, 
\end{split}\]</div>
<p>with elements</p>
<div class="math notranslate nohighlight">
\[
A = \left. \frac{\partial^2 p}{\partial x^2} \right|_{x_0,y_0}, \quad
B = \left. \frac{\partial^2 p}{\partial y^2} \right|_{x_0,y_0}, \quad
C = \left. \frac{\partial^2 p}{\partial x \partial y} \right|_{x_0,y_0}.
\]</div>
<!-- !split -->
<ul class="simple">
<li><p>So in this quadratic approximation the contour is an ellipse centered at <span class="math notranslate nohighlight">\((x_0,y_0)\)</span> with orientation and eccentricity determined by <span class="math notranslate nohighlight">\(A,B,C\)</span>.</p></li>
<li><p>The principal axes are found from the eigenvectors of <span class="math notranslate nohighlight">\(H\)</span>.</p></li>
<li><p>Depending on the skewness of the ellipse, the parameters are either (i) not correlated, (ii) correlated, or (iii) anti-correlated.</p></li>
<li><p>Take a minute to consider what that implies.</p></li>
</ul>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="errors"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>We’ll make the reasonable assumption that errors are Gaussian. In a Frequentist perspective, <span class="math notranslate nohighlight">\(e_i\)</span> is the standard deviation of the results of a single measurement event in the limit of repetitions of <em>that event</em>. In the Bayesian perspective, <span class="math notranslate nohighlight">\(e_i\)</span> is the standard deviation of the (Gaussian) probability distribution describing our knowledge of that particular measurement given its observed value.</p>
</dd>
</dl>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "physics-chalmers/tif285",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/BayesianStatistics/BayesianParameterEstimation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../BayesianBasics/exercise_sum_product_rule.html" title="previous page"><span class="section-number">13. </span>Checking the sum and product rules, and their consequences</a>
    <a class='right-next' id="next-link" href="demo-BayesianParameterEstimation.html" title="next page"><span class="section-number">15. </span>Bayesian parameter estimation demonstration</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Christian Forssén<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>